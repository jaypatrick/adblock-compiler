<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Vue PoC - Adblock Compiler</title>

        <!-- Vue 3 via CDN -->
        <script src="https://unpkg.com/vue@3.4.15/dist/vue.global.js"></script>
        <!-- Vue Router 4 via CDN -->
        <script src="https://unpkg.com/vue-router@4.2.5/dist/vue-router.global.js"></script>

        <style>
            /* =================================================================
               CSS Variables - Theming System
               Vue Pattern: CSS custom properties for theme management
               ================================================================= */
            :root {
                /* Brand Colors */
                --bg-gradient-start: #667eea;
                --bg-gradient-end: #764ba2;
                --primary: #667eea;
                --primary-dark: #5568d3;
                --secondary: #764ba2;

                /* Light Theme (Default) */
                --container-bg: #ffffff;
                --text-color: #333333;
                --text-muted: #666666;
                --border-color: #e0e0e0;
                --input-bg: #ffffff;
                --section-bg: #f8f9fa;
                --card-bg: #ffffff;
                --button-hover: #f5f5f5;

                /* Status Colors */
                --success: #10b981;
                --danger: #ef4444;
                --warning: #f59e0b;
                --info: #3b82f6;
            }

            /* Dark Theme */
            [data-theme='dark'] {
                --bg-gradient-start: #1a1a2e;
                --bg-gradient-end: #16213e;
                --container-bg: #1e1e2e;
                --text-color: #e0e0e0;
                --text-muted: #a0a0a0;
                --border-color: #3a3a4a;
                --input-bg: #2a2a3a;
                --section-bg: #252535;
                --card-bg: #2a2a3a;
                --button-hover: #3a3a4a;
            }

            /* =================================================================
               Base Styles
               ================================================================= */
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
                background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
                min-height: 100vh;
                color: var(--text-color);
                transition: background 0.3s ease;
            }

            /* =================================================================
               Layout Components
               ================================================================= */
            .app-container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
            }

            /* Navigation */
            .nav {
                background: var(--container-bg);
                border-radius: 12px;
                padding: 20px;
                margin-bottom: 20px;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .nav-links {
                display: flex;
                gap: 20px;
                list-style: none;
            }

            .nav-link {
                color: var(--text-muted);
                text-decoration: none;
                padding: 8px 16px;
                border-radius: 6px;
                transition: all 0.3s ease;
                font-weight: 500;
            }

            .nav-link:hover {
                background: var(--button-hover);
                color: var(--primary);
            }

            .nav-link.router-link-active {
                background: var(--primary);
                color: white;
            }

            /* Theme Toggle */
            .theme-toggle {
                background: var(--section-bg);
                border: 1px solid var(--border-color);
                color: var(--text-color);
                padding: 8px 16px;
                border-radius: 6px;
                cursor: pointer;
                font-size: 14px;
                transition: all 0.3s ease;
            }

            .theme-toggle:hover {
                background: var(--button-hover);
                transform: translateY(-2px);
            }

            /* Main Content */
            .main-content {
                background: var(--container-bg);
                border-radius: 12px;
                padding: 30px;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                min-height: 400px;
            }

            /* =================================================================
               Component Styles
               ================================================================= */

            /* Stats Cards (Home Page) */
            .stats-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 20px;
                margin: 30px 0;
            }

            .stat-card {
                background: var(--section-bg);
                padding: 24px;
                border-radius: 8px;
                border: 1px solid var(--border-color);
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }

            .stat-card:hover {
                transform: translateY(-4px);
                box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            }

            .stat-label {
                color: var(--text-muted);
                font-size: 14px;
                margin-bottom: 8px;
            }

            .stat-value {
                font-size: 32px;
                font-weight: 700;
                color: var(--primary);
            }

            /* Compiler Form */
            .form-section {
                margin-bottom: 30px;
            }

            .form-section h3 {
                margin-bottom: 15px;
                color: var(--text-color);
            }

            .url-list {
                display: flex;
                flex-direction: column;
                gap: 10px;
                margin-bottom: 15px;
            }

            .url-input-row {
                display: flex;
                gap: 10px;
            }

            .input {
                flex: 1;
                padding: 12px;
                border: 1px solid var(--border-color);
                border-radius: 6px;
                background: var(--input-bg);
                color: var(--text-color);
                font-size: 14px;
                transition: border-color 0.3s ease;
            }

            .input:focus {
                outline: none;
                border-color: var(--primary);
            }

            .btn {
                padding: 12px 24px;
                border: none;
                border-radius: 6px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .btn-primary {
                background: var(--primary);
                color: white;
            }

            .btn-primary:hover:not(:disabled) {
                background: var(--primary-dark);
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            }

            .btn-secondary {
                background: var(--section-bg);
                color: var(--text-color);
                border: 1px solid var(--border-color);
            }

            .btn-secondary:hover {
                background: var(--button-hover);
            }

            .btn-danger {
                background: var(--danger);
                color: white;
            }

            .btn-danger:hover {
                opacity: 0.9;
            }

            .btn:disabled {
                opacity: 0.5;
                cursor: not-allowed;
            }

            /* Transformations Checkboxes */
            .transformations-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 12px;
                margin-top: 15px;
            }

            .checkbox-label {
                display: flex;
                align-items: center;
                gap: 8px;
                padding: 10px;
                background: var(--section-bg);
                border-radius: 6px;
                cursor: pointer;
                transition: background 0.3s ease;
            }

            .checkbox-label:hover {
                background: var(--button-hover);
            }

            .checkbox-label input[type='checkbox'] {
                width: 18px;
                height: 18px;
                cursor: pointer;
            }

            /* Results Display */
            .results-container {
                margin-top: 30px;
                padding: 20px;
                background: var(--section-bg);
                border-radius: 8px;
                border: 1px solid var(--border-color);
            }

            .results-container h3 {
                margin-bottom: 15px;
                color: var(--text-color);
            }

            .results-code {
                background: var(--input-bg);
                padding: 15px;
                border-radius: 6px;
                overflow-x: auto;
                font-family: 'Courier New', monospace;
                font-size: 13px;
                color: var(--text-color);
                max-height: 400px;
                overflow-y: auto;
            }

            /* Loading & Error States */
            .loading {
                text-align: center;
                padding: 40px;
                color: var(--text-muted);
            }

            .spinner {
                border: 3px solid var(--border-color);
                border-top: 3px solid var(--primary);
                border-radius: 50%;
                width: 40px;
                height: 40px;
                animation: spin 1s linear infinite;
                margin: 0 auto 20px;
            }

            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            .alert {
                padding: 16px;
                border-radius: 6px;
                margin-bottom: 20px;
            }

            .alert-error {
                background: #fee2e2;
                color: #991b1b;
                border: 1px solid #fecaca;
            }

            .alert-success {
                background: #d1fae5;
                color: #065f46;
                border: 1px solid #a7f3d0;
            }

            .alert-info {
                background: #dbeafe;
                color: #1e40af;
                border: 1px solid #bfdbfe;
            }

            /* Utility Classes */
            .mb-2 {
                margin-bottom: 20px;
            }
            .mt-2 {
                margin-top: 20px;
            }
        </style>
    </head>
    <body>
        <div id="app"></div>

        <script>
            /* ===================================================================
           Vue PoC - Adblock Compiler Frontend

           ARCHITECTURE OVERVIEW:
           - Component-based architecture with Vue 3 Composition API
           - Reactive state management with ref() and reactive()
           - Vue Router for declarative routing
           - Computed properties for derived state
           - Lifecycle hooks (onMounted, watch) for side effects
           - Two-way data binding with v-model
           - Template-based declarative rendering

           KEY PATTERNS DEMONSTRATED:
           1. Composition API: setup(), ref(), reactive(), computed()
           2. Template Directives: v-for, v-if, v-model, v-on, :class
           3. Component Composition: Reusable components with props/emits
           4. Reactivity System: Automatic UI updates when state changes
           5. Router Integration: Declarative routing with <router-view>
           6. Event Handling: @click, @submit, @input
           =================================================================== */

            const { createApp, ref, reactive, computed, onMounted, watch } = Vue;
            const { createRouter, createWebHashHistory } = VueRouter;

            /* ===================================================================
           COMPOSABLE - Theme Management
           Vue Pattern: Composition API composable for reusable logic
           Similar to React custom hooks
           =================================================================== */
            function useTheme() {
                const theme = ref(localStorage.getItem('theme') || 'light');

                const toggleTheme = () => {
                    theme.value = theme.value === 'light' ? 'dark' : 'light';
                };

                // Watch for theme changes and persist
                watch(theme, (newTheme) => {
                    document.documentElement.setAttribute('data-theme', newTheme);
                    localStorage.setItem('theme', newTheme);
                }, { immediate: true });

                return {
                    theme,
                    toggleTheme,
                };
            }

            /* ===================================================================
           COMPONENT - Theme Toggle
           Vue Pattern: Simple component using Composition API
           =================================================================== */
            const ThemeToggle = {
                template: `
                <button class="theme-toggle" @click="toggleTheme">
                    {{ theme === 'light' ? 'üåô Dark Mode' : '‚òÄÔ∏è Light Mode' }}
                </button>
            `,
                setup() {
                    const { theme, toggleTheme } = useTheme();
                    return { theme, toggleTheme };
                },
            };

            /* ===================================================================
           COMPONENT - Navigation
           Vue Pattern: Router-aware navigation with router-link
           Uses scoped slots and dynamic classes
           =================================================================== */
            const Navigation = {
                template: `
                <nav class="nav">
                    <ul class="nav-links">
                        <li>
                            <router-link to="/" class="nav-link">
                                üè† Home
                            </router-link>
                        </li>
                        <li>
                            <router-link to="/compiler" class="nav-link">
                                ‚öôÔ∏è Compiler
                            </router-link>
                        </li>
                    </ul>
                    <theme-toggle />
                </nav>
            `,
                components: {
                    ThemeToggle,
                },
            };

            /* ===================================================================
           COMPONENT - Home/Dashboard Page
           Vue Pattern: Template-driven rendering with v-for directive
           Demonstrates declarative list rendering
           =================================================================== */
            const HomePage = {
                template: `
                <div>
                    <h1>Adblock Compiler Dashboard</h1>
                    <p class="mb-2" style="color: var(--text-muted)">
                        Welcome to the Adblock Compiler. Compile and transform filter lists with ease.
                    </p>
                    
                    <div class="stats-grid">
                        <div 
                            v-for="(stat, index) in stats" 
                            :key="index" 
                            class="stat-card"
                        >
                            <div class="stat-label">{{ stat.label }}</div>
                            <div class="stat-value">{{ stat.value }}</div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info mt-2">
                        <strong>‚ÑπÔ∏è Vue Pattern:</strong> This page demonstrates the Composition API, 
                        v-for directive for list rendering, and reactive data binding.
                    </div>
                </div>
            `,
                setup() {
                    const stats = ref([
                        { label: 'Filter Lists Compiled', value: '1,234' },
                        { label: 'Total Rules Processed', value: '456K' },
                        { label: 'Active Transformations', value: '12' },
                        { label: 'Cache Hit Rate', value: '89%' },
                    ]);

                    return { stats };
                },
            };

            /* ===================================================================
           COMPONENT - Compiler Form
           Vue Pattern: Complex form with reactive state and v-model binding
           Demonstrates two-way data binding, computed properties, and async methods
           =================================================================== */
            const CompilerPage = {
                template: `
                <div>
                    <h1>Compiler</h1>
                    <p class="mb-2" style="color: var(--text-muted)">
                        Configure and compile your filter lists
                    </p>
                    
                    <form @submit.prevent="handleCompile">
                        <!-- URL Inputs Section -->
                        <div class="form-section">
                            <h3>Filter List URLs</h3>
                            <div class="url-list">
                                <div 
                                    v-for="(url, index) in urls" 
                                    :key="index" 
                                    class="url-input-row"
                                >
                                    <input
                                        v-model="urls[index]"
                                        type="url"
                                        class="input"
                                        placeholder="https://example.com/filters.txt"
                                    />
                                    <button
                                        v-if="urls.length > 1"
                                        type="button"
                                        class="btn btn-danger"
                                        @click="removeUrl(index)"
                                    >
                                        Remove
                                    </button>
                                </div>
                            </div>
                            <button
                                type="button"
                                class="btn btn-secondary"
                                @click="addUrl"
                            >
                                + Add URL
                            </button>
                        </div>
                        
                        <!-- Transformations Section -->
                        <div class="form-section">
                            <h3>Transformations</h3>
                            <div class="transformations-grid">
                                <label 
                                    v-for="name in transformationNames" 
                                    :key="name" 
                                    class="checkbox-label"
                                >
                                    <input
                                        v-model="transformations[name]"
                                        type="checkbox"
                                    />
                                    <span>{{ name }}</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Submit Button -->
                        <button
                            type="submit"
                            class="btn btn-primary"
                            :disabled="loading"
                        >
                            {{ loading ? 'Compiling...' : 'üöÄ Compile' }}
                        </button>
                    </form>
                    
                    <!-- Loading State -->
                    <div v-if="loading" class="loading">
                        <div class="spinner"></div>
                        <p>Compiling filter lists...</p>
                    </div>
                    
                    <!-- Error State -->
                    <div v-if="error" class="alert alert-error mt-2">
                        <strong>‚ùå Error:</strong> {{ error }}
                    </div>
                    
                    <!-- Results Display -->
                    <div v-if="results" class="results-container">
                        <h3>‚úÖ Compilation Results</h3>
                        <div class="results-code">
                            <pre>{{ JSON.stringify(results, null, 2) }}</pre>
                        </div>
                    </div>
                    
                    <div class="alert alert-info mt-2">
                        <strong>‚ÑπÔ∏è Vue Pattern:</strong> This form demonstrates v-model for two-way 
                        data binding, v-for for dynamic lists, computed properties, and async methods 
                        with loading/error state management.
                    </div>
                </div>
            `,
                setup() {
                    // Reactive State - Vue's reactivity system
                    const urls = ref(['']);
                    const transformations = reactive({
                        RemoveComments: true,
                        Deduplicate: true,
                        TrimLines: false,
                        RemoveEmptyLines: false,
                        Compress: false,
                        RemoveModifiers: false,
                        Validate: false,
                        ValidateAllowIp: false,
                        InvertAllow: false,
                        InsertFinalNewLine: false,
                        ConvertToAscii: false,
                    });
                    const loading = ref(false);
                    const error = ref(null);
                    const results = ref(null);

                    // Computed property for transformation names
                    const transformationNames = computed(() => {
                        return Object.keys(transformations);
                    });

                    // Methods
                    const addUrl = () => {
                        urls.value.push('');
                    };

                    const removeUrl = (index) => {
                        if (urls.value.length > 1) {
                            urls.value.splice(index, 1);
                        }
                    };

                    const handleCompile = async () => {
                        // Validation
                        const validUrls = urls.value.filter((url) => url.trim() !== '');
                        if (validUrls.length === 0) {
                            error.value = 'Please enter at least one URL';
                            return;
                        }

                        // Get selected transformations
                        const selectedTransformations = Object.entries(transformations)
                            .filter(([name, enabled]) => enabled)
                            .map(([name]) => name);

                        // Prepare request payload
                        const payload = {
                            configuration: {
                                name: 'Vue PoC Compilation',
                                sources: validUrls.map((url) => ({ source: url })),
                                transformations: selectedTransformations,
                            },
                            benchmark: true,
                        };

                        // API Call with loading/error handling
                        loading.value = true;
                        error.value = null;
                        results.value = null;

                        try {
                            // In production, use actual API endpoint
                            const response = await fetch('/api/compile', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify(payload),
                            });

                            if (!response.ok) {
                                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                            }

                            const data = await response.json();
                            results.value = data;
                        } catch (err) {
                            // Mock success for demo purposes (API might not be available)
                            console.log('API call failed (expected in PoC), showing mock data:', err);
                            results.value = {
                                success: true,
                                ruleCount: 1234,
                                sources: validUrls.length,
                                transformations: selectedTransformations,
                                message: 'Mock compilation result (API not available in PoC)',
                                benchmark: {
                                    duration: '123ms',
                                    rulesPerSecond: 10000,
                                },
                            };
                        } finally {
                            loading.value = false;
                        }
                    };

                    return {
                        urls,
                        transformations,
                        transformationNames,
                        loading,
                        error,
                        results,
                        addUrl,
                        removeUrl,
                        handleCompile,
                        JSON,
                    };
                },
            };

            /* ===================================================================
           ROUTER CONFIGURATION
           Vue Pattern: Declarative routing with Vue Router 4
           =================================================================== */
            const routes = [
                { path: '/', component: HomePage },
                { path: '/compiler', component: CompilerPage },
            ];

            const router = createRouter({
                history: createWebHashHistory(),
                routes,
            });

            /* ===================================================================
           ROOT COMPONENT - Application Entry Point
           Vue Pattern: App shell with router-view for nested routing
           =================================================================== */
            const App = {
                template: `
                <div class="app-container">
                    <navigation />
                    <main class="main-content">
                        <router-view />
                    </main>
                </div>
            `,
                components: {
                    Navigation,
                },
            };

            /* ===================================================================
           BOOTSTRAP - Create and Mount Vue App
           =================================================================== */
            const app = createApp(App);
            app.use(router);
            app.mount('#app');
        </script>
    </body>
</html>
